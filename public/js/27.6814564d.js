(self["webpackChunkbackoffice_artchie_front"]=self["webpackChunkbackoffice_artchie_front"]||[]).push([[27],{38515:(e,t,a)=>{"use strict";a.d(t,{U:()=>s});var r=a(99623);class s extends r.Z{constructor(){super("museum")}async get(e){const{museum:t}=await super.get(e);return t}}},88722:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>$e});a(90246);var r=a(83673);const s={class:"q-py-md"},o={class:"container flex-start"},l=(0,r.Uk)(" Click to generate app access key "),n={id:"viewer",href:"#",ref:"downloader"};function u(e,t,a,u,m,i){const c=(0,r.up)("cool-museum-bg"),d=(0,r.up)("museum-content"),p=(0,r.up)("media-museum"),k=(0,r.up)("q-tooltip"),f=(0,r.up)("q-btn"),g=(0,r.up)("marker-table");return(0,r.wg)(),(0,r.iD)("div",s,[(0,r._)("div",o,[(0,r.Wm)(c),(0,r.Wm)(d,{"museum-name":u.museum.name,"museum-email":u.museum.email,"museum-info":u.museum.info,"museum-description":u.museum.description},null,8,["museum-name","museum-email","museum-info","museum-description"]),(0,r.Wm)(p,{"museum-image":u.museum.image},null,8,["museum-image"]),(0,r.Wm)(f,{fab:"",icon:"key",color:"accent",class:"key-gen-btn",onClick:u.generateKey},{default:(0,r.w5)((()=>[(0,r.Wm)(k,{anchor:"top left",self:"top middle"},{default:(0,r.w5)((()=>[l])),_:1})])),_:1},8,["onClick"])]),(0,r._)("a",n,null,512),(0,r.Wm)(g,{"museum-id":u.museum.id},null,8,["museum-id"])])}const m={class:"bg-border-radius"};function i(e,t){return(0,r.wg)(),(0,r.iD)("div",m)}var c=a(74260);const d={},p=(0,c.Z)(d,[["render",i],["__scopeId","data-v-705198fb"]]),k=p;var f=a(62323);const g=e=>((0,r.dD)("data-v-3f940612"),e=e(),(0,r.Cn)(),e),b={class:"container__content"},h={class:"text-h4 ellipsis"},w={class:"ellipsis text-subtitle1"},y={class:"text-description"},v=g((()=>(0,r._)("div",{class:"date-museum"},"InclusÃ£o: 25/04/2021",-1)));function _(e,t,a,s,o,l){return(0,r.wg)(),(0,r.iD)("div",b,[(0,r._)("h1",h,(0,f.zw)(a.museumName),1),(0,r._)("div",w,(0,f.zw)(a.museumInfo),1),(0,r._)("p",y,(0,f.zw)(a.museumDescription),1),v])}const q={props:{museumName:{type:String},museumEmail:{type:String},museumInfo:{type:String,default:""},museumDescription:{type:String,default:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua."}}},x=(0,c.Z)(q,[["render",_],["__scopeId","data-v-3f940612"]]),W=x,C={class:"container__media"},I={class:"avatar"},Z=["src"];function M(e,t,a,s,o,l){return(0,r.wg)(),(0,r.iD)("div",C,[(0,r._)("div",I,[(0,r._)("img",{src:a.museumImage,alt:""},null,8,Z)])])}const j={props:{museumImage:{type:String,default:a(18575)}}},V=(0,c.Z)(j,[["render",M],["__scopeId","data-v-592548c9"]]),S=V,Q=e=>((0,r.dD)("data-v-295723a6"),e=e(),(0,r.Cn)(),e),A={class:"q-my-md"},D=Q((()=>(0,r._)("div",{class:"text-h6"},"Markers",-1))),U=["src"];function z(e,t,a,s,o,l){const n=(0,r.up)("q-space"),u=(0,r.up)("q-icon"),m=(0,r.up)("q-input"),i=(0,r.up)("q-btn"),c=(0,r.up)("q-avatar"),d=(0,r.up)("q-td"),p=(0,r.up)("q-tr"),k=(0,r.up)("marker-table-skeletons"),g=(0,r.up)("q-table"),b=(0,r.up)("create-marker");return(0,r.wg)(),(0,r.iD)("div",A,[(0,r.Wm)(g,{class:"container",title:"Markers",rows:s.rows,columns:s.columns,"row-key":"markerName"},{top:(0,r.w5)((()=>[D,(0,r.Wm)(n),(0,r.Wm)(m,{dense:"",debounce:"300",color:"primary"},{append:(0,r.w5)((()=>[(0,r.Wm)(u,{name:"search"})])),_:1}),(0,r.Wm)(i,{round:"",icon:"add",class:"q-ml-sm colored-btn",size:"md",onClick:l.openMarkerCreatorCard},null,8,["onClick"])])),body:(0,r.w5)((e=>[s.hasMarkers?((0,r.wg)(),(0,r.j4)(p,{key:0,props:e},{default:(0,r.w5)((()=>[(0,r.Wm)(d,{key:"asset",props:e},{default:(0,r.w5)((()=>[(0,r.Wm)(c,{size:"45px",class:"shadow-10",onClick:t=>l.openCard(e.row.id)},{default:(0,r.w5)((()=>[(0,r._)("img",{src:e.row.asset},null,8,U)])),_:2},1032,["onClick"])])),_:2},1032,["props"]),(0,r.Wm)(d,{key:"markerName",props:e},{default:(0,r.w5)((()=>[(0,r.Uk)((0,f.zw)(e.row.markerName),1)])),_:2},1032,["props"]),(0,r.Wm)(d,{key:"text",props:e,class:"ellipsis"},{default:(0,r.w5)((()=>[(0,r.Uk)((0,f.zw)(l.truncateText(e.row.text)),1)])),_:2},1032,["props"]),(0,r.Wm)(d,{key:"title",props:e},{default:(0,r.w5)((()=>[(0,r.Uk)((0,f.zw)(e.row.title),1)])),_:2},1032,["props"]),(0,r.Wm)(d,{key:"path",props:e},{default:(0,r.w5)((()=>[(0,r.Uk)((0,f.zw)(e.row.path),1)])),_:2},1032,["props"])])),_:2},1032,["props"])):((0,r.wg)(),(0,r.j4)(p,{key:1},{default:(0,r.w5)((()=>[(0,r.Wm)(k)])),_:1}))])),_:1},8,["rows","columns"]),(0,r.Wm)(b,{modelValue:s.markerCreator,"onUpdate:modelValue":t[0]||(t[0]=e=>s.markerCreator=e),onSuccessCreated:l.insertMarker},null,8,["modelValue","onSuccessCreated"])])}var P=a(61959);const F=[{name:"asset",required:!0,label:"Item",align:"left",field:e=>e.name,format:e=>`${e}`,sortable:!0},{name:"markerName",align:"left",label:"Name",field:"markerName",sortable:!0},{name:"text",label:"Description",align:"left",field:"text",sortable:!1},{name:"title",label:"Title",align:"left",field:"title"},{name:"path",label:"Path",align:"left",field:"path"}];function N(e,t){const a=(0,r.up)("q-skeleton"),s=(0,r.up)("q-td");return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r.Wm)(s,{key:"asset",props:e.props,onClick:t[0]||(t[0]=t=>e.$emit("open-card"))},{default:(0,r.w5)((()=>[(0,r.Wm)(a,{type:"circle"})])),_:1},8,["props"]),(0,r.Wm)(s,{key:"markerName",props:e.props},{default:(0,r.w5)((()=>[(0,r.Wm)(a,{type:"text"})])),_:1},8,["props"]),(0,r.Wm)(s,{key:"text",props:e.props},{default:(0,r.w5)((()=>[(0,r.Wm)(a,{type:"text"})])),_:1},8,["props"]),(0,r.Wm)(s,{key:"title",props:e.props},{default:(0,r.w5)((()=>[(0,r.Wm)(a,{type:"text"})])),_:1},8,["props"]),(0,r.Wm)(s,{key:"path",props:e.props},null,8,["props"])],64)}var T=a(83884),K=a(54103),O=a(7518),B=a.n(O);const H={},R=(0,c.Z)(H,[["render",N]]),$=R;B()(H,"components",{QTd:T.Z,QSkeleton:K.ZP});const L={class:"q-pa-md"};function E(e,t,a,s,o,l){const n=(0,r.up)("asset-form"),u=(0,r.up)("marker-card-actions"),m=(0,r.up)("q-card"),i=(0,r.up)("q-dialog");return(0,r.wg)(),(0,r.j4)(i,{ref:"create-marker-dialog","onUpdate:modelValue":l.updateModelValue,value:a.modelValue},{default:(0,r.w5)((()=>[(0,r.Wm)(m,{class:"create-marker-card"},{default:(0,r.w5)((()=>[(0,r._)("div",L,[(0,r.Wm)(n,{onCloseDialog:l.submittedSuccessfully},null,8,["onCloseDialog"])]),(0,r.Wm)(u)])),_:1})])),_:1},8,["onUpdate:modelValue","value"])}var Y=a(32310);const G=e=>((0,r.dD)("data-v-270db619"),e=e(),(0,r.Cn)(),e),X=G((()=>(0,r._)("div",{class:"q-form-section-break q-form-builder-element",required:"required",debounce:"500"},[(0,r._)("p",{class:"text-h5 text-center text-white q-py-md form-title"}," Create Marker "),(0,r._)("hr",{role:"separator","aria-orientation":"horizontal",class:"q-separator q-separator--horizontal bg-purple",style:{"margin-bottom":"8px","margin-top":"8px"}}),(0,r._)("p",{class:"text-caption"},"Define a marker and its placement object")],-1))),J=G((()=>(0,r._)("div",{class:"q-form-section-break q-form-builder-element",required:"required",debounce:"500"},[(0,r._)("label",{class:"text-h6"},"Pose Object"),(0,r._)("hr",{role:"separator","aria-orientation":"horizontal",class:"q-separator q-separator--horizontal bg-purple",style:{"margin-bottom":"8px","margin-top":"8px"}}),(0,r._)("p",{class:"text-caption"},"Which object will be placed over this marker?")],-1)));function ee(e,t,a,s,o,l){const n=(0,r.up)("q-input"),u=(0,r.up)("image-files"),m=(0,r.up)("q-btn"),i=(0,r.up)("q-form");return(0,r.wg)(),(0,r.j4)(i,{onSubmit:s.onSubmit,onReset:s.onReset,class:"q-gutter-md"},{default:(0,r.w5)((()=>[X,(0,r.Wm)(n,{filled:"",modelValue:s.marker.marker_name,"onUpdate:modelValue":t[0]||(t[0]=e=>s.marker.marker_name=e),label:"Marker name *",hint:"The original marker name","lazy-rules":"",rules:[e=>e&&e.length>0||"Please type something"]},null,8,["modelValue","rules"]),(0,r.Wm)(n,{filled:"",modelValue:s.marker.marker_title,"onUpdate:modelValue":t[1]||(t[1]=e=>s.marker.marker_title=e),label:"Marker title",hint:"An associated title can be displayed to your final user based on this marker","lazy-rules":""},null,8,["modelValue"]),(0,r.Wm)(n,{filled:"",modelValue:s.marker.marker_text,"onUpdate:modelValue":t[2]||(t[2]=e=>s.marker.marker_text=e),label:"Marker text",hint:"An associated text can be displayed to your final user based on this marker","lazy-rules":""},null,8,["modelValue"]),(0,r.Wm)(u,{onFilechanged:s.addMarkerAsset,ref:"fileMarker"},null,8,["onFilechanged"]),J,(0,r.Wm)(n,{filled:"",modelValue:s.marker.pose_object.pose_object_name,"onUpdate:modelValue":t[3]||(t[3]=e=>s.marker.pose_object.pose_object_name=e),label:"Object name*",hint:"The name for this placement object","lazy-rules":"",rules:[e=>e&&e.length>0||"Please type something"]},null,8,["modelValue","rules"]),(0,r.Wm)(u,{onFilechanged:s.addObjectAsset,ref:"filePlacementObject"},null,8,["onFilechanged"]),(0,r._)("div",null,[(0,r.Wm)(m,{label:"Submit",type:"submit",color:"primary"}),(0,r.Wm)(m,{label:"Reset",type:"reset",color:"primary",flat:"",class:"q-ml-sm"})])])),_:1},8,["onSubmit","onReset"])}var te=a(48825);function ae(e,t,a,s,o,l){const n=(0,r.up)("q-icon"),u=(0,r.up)("q-file");return(0,r.wg)(),(0,r.j4)(u,{clearable:"",color:"teal",standout:"","bottom-slots":"",filled:"",modelValue:s.model,"onUpdate:modelValue":t[0]||(t[0]=e=>s.model=e),label:"Asset",counter:"",ref:"fileupload"},{prepend:(0,r.w5)((()=>[(0,r.Wm)(n,{name:"cloud_upload"})])),_:1},8,["modelValue"])}const re={setup(){return{model:(0,P.iH)(null)}},watch:{model(e,t){this.$emit("filechanged",e)}},methods:{cleanInput(){this.model=null,this.$refs.fileupload.value=null}}};var se=a(64974),oe=a(24554);const le=(0,c.Z)(re,[["render",ae]]),ne=le;B()(re,"components",{QFile:se.Z,QIcon:oe.Z});var ue=a(93617),me=a(45342),ie=a(3428),ce=a(10555);const de=async(e,t,a,r,s,o)=>{if(!s||!o)return;const l=new ie.p(e,t),n=new ce.A(e,t),u=new me.Y(l,n);return u.post(a,r,s,o)};var pe=a(74755);const ke={components:{ImageFiles:ne},setup(e,{emit:t}){const a=(0,te.Z)(),s=(0,P.iH)(null),o=(0,P.iH)(null),l=(0,r.f3)("uuid",""),n=(0,r.f3)("museumId"),u=(0,pe.P)(),m=(0,P.iH)(null),i=(0,P.iH)(null),c=(0,ue.oR)(),d=(0,P.qj)({...u}),p=(0,P.Fl)((()=>c.getters["auth/userToken"])),k=()=>{Object.assign(d,{...u}),s.value=null,o.value=null,m.value.cleanInput(),i.value.cleanInput()};return{marker:d,markerAsset:s,poseAsset:o,addMarkerAsset:e=>{s.value=e},addObjectAsset:e=>{o.value=e},onSubmit:async()=>{try{const e=await de(p.value,l.value,n.value,d,s.value,o.value);e?(a.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"Submitted!"}),k(),t("close-dialog",e)):a.notify({color:"red-5",textColor:"white",icon:"close",message:"Missing values!"})}catch(e){a.dialog({title:"Error",message:e.data,class:"negative"})}},filePlacementObject:m,fileMarker:i,onReset:k}}};var fe=a(68689),ge=a(65869),be=a(64689),he=a(48240);const we=(0,c.Z)(ke,[["render",ee],["__scopeId","data-v-270db619"]]),ye=we;B()(ke,"components",{QForm:fe.Z,QSeparator:ge.Z,QInput:be.Z,QBtn:he.Z});const ve={components:{MarkerCardActions:Y.Z,AssetForm:ye},setup(){return{marker:(0,P.qj)({})}},props:{modelValue:{type:Boolean,default:!1}},computed:{textActive(){return this.active?"Item is active":"Item is inactive"}},methods:{updateModelValue(e){this.$emit("update:modelValue",e)},submittedSuccessfully(){this.$emit("success-created")}},watch:{modelValue(e){e&&this.$refs["create-marker-dialog"].show()}}};var _e=a(46778),qe=a(10151);const xe=(0,c.Z)(ve,[["render",E],["__scopeId","data-v-63a9cad4"]]),We=xe;B()(ve,"components",{QDialog:_e.Z,QCard:qe.Z});var Ce=a(76992),Ie=a.n(Ce);Ie().config.region="us-east-1",Ie().config.credentials=new(Ie().CognitoIdentityCredentials)({IdentityPoolId:"us-east-1:354f6195-da5e-4f87-baec-580196c849bf"});new(Ie().S3)({apiVersion:"2006-03-01",params:{Bucket:"marker-thumbs"}});const Ze=e=>{const t=new AWS.S3({accessKeyId:"AKIAR6NIGP6SYLPWKJM2",secretAccessKey:"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",Bucket:"marker-thumbs"}),a=t.getSignedUrl("getObject",{Bucket:"marker-thumbs",Key:`thumb-${e}`,Expires:300});return a},Me={components:{CreateMarker:We,MarkerTableSkeletons:$},props:{museumId:{type:Number}},setup(e){const t=(0,P.Fl)((()=>!!a.value.length)),a=(0,P.iH)([]),s=(0,P.iH)(null),o=(0,P.Fl)((()=>a.value.map((e=>({id:e.id,asset:Ze(e.asset.path),markerName:e.name,text:e.dataInfo.text,title:e.dataInfo.title,path:e.asset.path}))))),l=async e=>{const t=new me.X,r=await t.fetchByMuseumId(e);a.value=r.items};return(0,r.YP)((()=>e.museumId),((t,a)=>{t&&l(e.museumId)})),{columns:(0,P.qj)(F),rows:o,markerCreator:(0,P.iH)(!1),hasMarkers:t,getMarkers:l,selectedMarker:s}},methods:{openCard(e){this.$router.push({name:"markerPage",params:{id:e}})},openMarkerCreatorCard(){this.markerCreator=!0},insertMarker(){this.getMarkers(this.museumId)},truncateText(e){return e.length<45?e:e.substring(0,45)+"..."}}};var je=a(99249),Ve=a(62025),Se=a(18186),Qe=a(75096);const Ae=(0,c.Z)(Me,[["render",z],["__scopeId","data-v-295723a6"]]),De=Ae;B()(Me,"components",{QTable:je.Z,QSpace:Ve.Z,QInput:be.Z,QIcon:oe.Z,QBtn:he.Z,QTr:Se.Z,QTd:T.Z,QAvatar:Qe.Z});var Ue=a(79582),ze=a(38515),Pe=a(6394),Fe=a(52098);const Ne=async e=>{const t=window.navigator.onLine,a=(0,te.Z)(),r=new ze.U,s=(0,Ue.tv)();a.loading.show({message:t?"Loading your user information...":"Looks like you've lost network connectivity. Please connect back to your network to access your data.",backgroundColor:t?"grey":"red-6",spinner:t?Pe.Z:Fe.Z,customClass:"loader"});try{const t=await r.get(e);return t||a.dialog({title:"Error",message:"O museu nÃ£o existe",class:"negative"}).onDismiss((()=>s.push("/intern/museums"))),t}catch({data:o}){a.dialog({title:"Error",message:o,class:"negative"})}finally{a.loading.hide()}};a(10071),a(17965);function Te(e,t){const a="text/plain",r=new Blob([t],{type:a});e.href=URL.createObjectURL(r),e.download="appKey.cert",e.click()}var Ke=a(99623);class Oe extends Ke.Z{constructor(){super("create-app-key")}async makeKey(e){return super.post({uuid:e})}}const Be={components:{CoolMuseumBg:k,MuseumContent:W,MediaMuseum:S,MarkerTable:De},setup(){const e=(0,te.Z)();let t=(0,P.qj)({id:void 0,name:"",mail:"",info:"",description:"",image:"",uuid:""});const a=(0,P.iH)([]),r=(0,P.iH)(null),s=async()=>{try{const a=new Oe,{data:s}=await a.makeKey(t.uuid);Te(r.value,s.token),e.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"API Key downloaded"})}catch(a){e.notify({color:"red",textColor:"white",icon:"cloud_off",message:"Museum code is invalid"})}},o=(0,Ue.yj)();return Ne(o.params.id).then((e=>Object.assign(t,e))),{museum:t,markers:a,downloader:r,generateKey:s}},provide(){return{uuid:(0,P.Fl)((()=>this.museum.uuid)),museumId:(0,P.Fl)((()=>this.museum.id))}}};var He=a(5363);const Re=(0,c.Z)(Be,[["render",u],["__scopeId","data-v-72f39420"]]),$e=Re;B()(Be,"components",{QBtn:he.Z,QTooltip:He.Z})},18575:(e,t,a)=>{e.exports=a.p+"img/louvre.ddb823bf.jpg"},28022:()=>{}}]);